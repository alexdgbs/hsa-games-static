(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{297:function(e,t,r){var content=r(313);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(66).default)("6b3412f4",content,!0,{sourceMap:!1})},312:function(e,t,r){"use strict";r(297)},313:function(e,t,r){var n=r(65)((function(i){return i[1]}));n.push([e.i,'body[data-v-05be2e90]{font-family:"Inter",sans-serif}h2[data-v-05be2e90]{color:#1f2937;font-size:1.25rem}h3[data-v-05be2e90]{color:#374151;font-size:1rem}.bg-white[data-v-05be2e90]{background-color:#fff}#paypal-button-container[data-v-05be2e90]{display:flex;justify-content:center;z-index:10}.bg-gray-100[data-v-05be2e90]{padding:.5rem}.space-y-6>*+*[data-v-05be2e90]{margin-top:1.5rem}.flex[data-v-05be2e90]{margin-top:1rem}.menu[data-v-05be2e90]{z-index:50}.fade-in[data-v-05be2e90]{animation:fadeIn-05be2e90 .5s forwards;opacity:0;transform:translateY(20px)}@keyframes fadeIn-05be2e90{to{opacity:1;transform:translateY(0)}}',""]),n.locals={},e.exports=n},346:function(e,t,r){"use strict";r.r(t);var n=r(10),o=(r(207),r(33),r(18),r(111),r(206),r(47),{data:function(){return{isSubscribed:!1}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var script;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkSubscription();case 2:e.isSubscribed||((script=document.createElement("script")).src="https://www.paypal.com/sdk/js?client-id=AXQeb763-UfMzlLsheOGAQdXyM-xzZ4MPxXXZAaZ44MQT-7bWdbDuiRxl6-gwxuCgXf6Jnc0LKSdL1vk&currency=MXN",script.addEventListener("load",e.renderPayPalButton),document.body.appendChild(script));case 3:case"end":return t.stop()}}),t)})))()},methods:{checkSubscription:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=document.cookie.split(";").find((function(e){return e.trim().startsWith("email=")})))){t.next=17;break}return n=r.split("=")[1],t.prev=3,t.next=6,fetch("https://api.hsa-games.com/api/user?email=".concat(n));case 6:if(!(o=t.sent).ok){t.next=12;break}return t.next=10,o.json();case 10:c=t.sent,e.isSubscribed=c.isSubscribed;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),console.error("Error al obtener la información del usuario:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,14]])})))()},renderPayPalButton:function(){var e,t=this;window.paypal?window.paypal.Buttons({createOrder:function(data,e){return e.order.create({purchase_units:[{amount:{value:"49.00"}}]})},onApprove:(e=Object(n.a)(regeneratorRuntime.mark((function e(data,r){var n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.order.capture();case 3:if(n=e.sent,o=document.cookie.split(";").find((function(e){return e.trim().startsWith("email=")})),!(c=o?o.split("=")[1]:null)){e.next=14;break}return e.next=9,fetch("https://api.hsa-games.com/api/update-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c,isSubscribed:!0})});case 9:if(e.sent.ok){e.next=12;break}throw new Error("Error al actualizar la suscripción");case 12:t.isSubscribed=!0,window.dispatchEvent(new CustomEvent("subscription-updated",{detail:{isSubscribed:!0}}));case 14:alert("Transacción completada por "+n.payer.name.given_name),t.$router.push("/success"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("Error en el proceso de pago:",e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])}))),function(t,r){return e.apply(this,arguments)}),onError:function(e){console.error("Error en el proceso de pago:",e)}}).render("#paypal-button-container"):console.error("PayPal SDK no está cargado.")},cancelSubscription:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=document.cookie.split(";").find((function(e){return e.trim().startsWith("email=")})),!(n=r?r.split("=")[1]:null)){t.next=15;break}return t.next=6,fetch("https://api.hsa-games.com/api/update-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,isSubscribed:!1})});case 6:if(t.sent.ok){t.next=9;break}throw new Error("Error al cancelar la suscripción");case 9:e.isSubscribed=!1,window.dispatchEvent(new CustomEvent("subscription-updated",{detail:{isSubscribed:!1}})),alert("Suscripción cancelada con éxito"),e.$router.push("/cancel"),t.next=16;break;case 15:alert("No se encontró un correo electrónico en las cookies");case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),console.error("Error en el proceso de cancelación:",t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})))()}}}),c=o,d=(r(312),r(32)),component=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"relative z-0 bg-white max-w-sm mx-auto py-6 px-2 sm:px-4 lg:px-6 fade-in"},[t("div",{staticClass:"space-y-6"},[t("div",[t("h2",{staticClass:"text-center text-2xl font-semibold text-gray-900"},[e._v("\n        "+e._s(e.isSubscribed?"Nostalgia":"Suscríbete por solo $49")+"\n      ")]),e._v(" "),t("p",{staticClass:"mt-1 text-center text-sm text-gray-600"},[e._v("\n        "+e._s(e.isSubscribed?"Retro-Arcade":"Elige el método de pago y accede a contenido exclusivo.")+"\n      ")])]),e._v(" "),t("div",{staticClass:"bg-gray-100 py-4 px-2 shadow sm:rounded-lg sm:px-6"},[t("h3",{staticClass:"text-lg font-medium text-gray-700 text-center mb-4"},[e._v("\n        "+e._s(e.isSubscribed?"Suscrito":"Métodos de Pago")+"\n      ")]),e._v(" "),e.isSubscribed?e._e():t("div",{staticClass:"mt-2 relative",attrs:{id:"paypal-button-container"}}),e._v(" "),e.isSubscribed?t("button",{staticClass:"mt-4 w-full rounded-md bg-red-400 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-red-500",on:{click:e.cancelSubscription}},[e._v("\n        Cancelar Suscripción\n      ")]):e._e()])])])}),[],!1,null,"05be2e90",null);t.default=component.exports}}]);